"use strict";var app=angular.module("app",["ngRoute","ngMessages","firebase","jsonFormatter"]);app.config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{title:"Homepage",templateUrl:"partials/home.html",controller:"HomeCtrl"}).when("/signin",{title:"Accedi",templateUrl:"partials/signin.html",controller:"SigninCtrl"}).when("/dashboard",{title:"Dashboard",templateUrl:"partials/dashboard.html",controller:"DashboardCtrl"}).when("/user/:userId",{title:"User",templateUrl:"partials/user.html",controller:"UserCtrl",resolve:{user:["User",function(e){return e.isLoggedOrGoTo("/signin")}]}}).when("/404",{title:"Error 404",templateUrl:"partials/404"}),t.html5Mode(!1),t.hashPrefix("")}]),app.config(["$httpProvider",function(e){e.defaults.withCredentials=!0}]),app.run(["$rootScope","$route","$routeParams","$window","$document","$q","$timeout",function(e,t,r,n,s,o,i){function a(t){var r=-1;angular.forEach(e.modals,function(e,n){e===t&&(r=n)}),-1!==r&&(t.active=!1,i(function(){e.modals.splice(r,1)},500))}e.standalone=n.navigator.standalone,e.$on("$routeChangeSuccess",function(){var e=t.current.title;angular.forEach(r,function(t,r){e=e.replace(new RegExp(":"+r,"g"),t)}),s.title=e||""}),e.log=function(){n.console&&n.console.info&&n.console.info.apply(n.console,arguments)},e.modals=[],e.addModal=function(t,r,s){var l=o.defer();s=s||null;var c={title:"Untitled",controller:null,template:null,params:s};switch(t){case"messageModal":c={title:r||"Messaggio",controller:"MessageModalCtrl",template:"partials/modals/message",params:s}}return c.deferred=l,c.resolve=function(e){a(this),c.deferred.resolve(e,c)},c.reject=function(){a(this),c.deferred.reject(c)},e.modals.push(c),angular.forEach(e.modals,function(e,t){e.active=!1}),i(function(){c.active=!0,n.scrollTo(0,0)},500),l.promise}}]),app.controller("RootCtrl",["$scope",function(e){}]),app.controller("HomeCtrl",["$scope","$location","$timeout","State",function(e,t,r,n){(e.state=new n).ready()}]),app.controller("DashboardCtrl",["$scope","$location","$timeout","State","FirebaseApi",function(e,t,r,n,s){var o=e.state=new n;e.user=s.auth.current();o.ready()}]),app.controller("SigninCtrl",["$scope","$location","$timeout","State","FirebaseApi",function(e,t,r,n,s){var o=e.state=new n,i=e.model={userName:"username",password:"password"};e.submit=function(){o.busy()&&s.auth.signin(i).then(function(e){o.success(),r(function(){var r=t.$$lastRequestedPath||"/dashboard";console.log("SigninCtrl",r,e),t.path(r),t.$$lastRequestedPath=null},1e3)},function(e){console.log("SigninCtrl.error",e),o.error(e)})}}]),app.controller("DemoCtrl",["$scope","$interval","Hash","Calendar","GanttRow",function(e,t,r,n,s){function o(e){function t(e,t,r){return e=(e||0)+"",t=t||2,r=r||"0",e.length>=t?e:new Array(t-e.length+1).join(r)+e}var r=e.getFullYear(),n=e.getMonth()+1,s=e.getDate(),o=e.getHours(),i=e.getMinutes(),a=e.getSeconds();return r+"-"+t(n)+"-"+t(s)+"T"+t(o)+":"+t(i)+":"+t(a)}function i(){var e=new Date;e.setDate(e.getDate()+Math.floor(60*Math.random())),e.setHours(0),e.setMinutes(0),e.setSeconds(0);var t=e.getFullYear(),r=e.getMonth();return{key:Math.ceil(e.getTime()/864e5),mKey:12*t+r,date:o(e)}}function a(){var e=i(),t={id:d,hours:1+Math.floor(6*Math.random()),date:new Date(e.date),key:e.key,mKey:e.mKey,activityId:c.id};return 0===Math.floor(3*Math.random())&&(t.taskId=1e4+Math.floor(50*Math.random())),d++,t}function l(){e.log=Array.prototype.slice.call(arguments)}var c=e.row=new s({activity:{id:1e6+function(){return 1e6+Math.floor(1e5*Math.random())}(),name:"Activity",budgetHours:10+Math.floor(50*Math.random())},project:{type:Math.floor(5*Math.random()),deliveryDate:new Date}},[]);e.addItem=function(){var t=a();c.slots.add(t),c.update(),c.updateMonths(),e.item=t,l("addItem",t.id)},e.updateItem=function(){if(e.item){var t=e.item.id;item=a(),item=angular.extend(e.item,item),item.id=t,c.slots.add(item),c.update(),c.updateMonths(),e.item=item,l("updateItem",item.id)}},e.clearItems=function(){c.ranges.removeAll(),c.months.removeAll(),c.days.removeAll(),c.slots.removeAll(),c.update(),c.updateMonths(),delete e.item,l("clearItems")};var u;e.start=function(){e.stop(),u=t(e.addItem,1e3/60)},e.stop=function(){u&&t.cancel(u)};var d=1}]),app.constant("ganttGroups",{ACTIVITY:1,CUSTOMER:2,DEPARTMENT:3,GROUP:4,MANAGER:5,PROJECT:6,RESOURCE:7,USER:9}),app.factory("Hash",[function(){function e(t,r){t=t||"id",r=r?e.get(r):{},Object.defineProperties(this,{key:{value:t,enumerable:!1,writable:!1},pool:{value:r,enumerable:!1,writable:!1},length:{value:0,enumerable:!1,writable:!0}})}function t(e){return void 0!==this.pool[e]}function r(e){return this.pool[e]}function n(e){var t=this,r=this.key;return e?t.getId(e[r]):null}function s(e){var t=this;return this.pool[e[this.key]]=e,t.push(e),e}function o(e){var t=this,r=t.get(e);if(r)for(var n,s=0,o=Object.keys(e);s<o.length;s++)n=o[s],r[n]=e[n];else r=t.set(e);return r}function i(e){var t=this,r=this.pool,n=this.key,s=t.get(e);if(s){var o=t.indexOf(s);-1!==o&&t.splice(o,1),delete r[s[n]]}return t}function a(e){var t=this;if(!e)return t;for(var r=0;r<e.length;)t.add(e[r]),r++;return t}function l(e){var t=this;if(!e)return t;for(var r=0;r<e.length;)t.remove(e[r]),r++;return t}function c(){var e,t=this,r=t.key,n=t.pool,s=0;for(t.length;t.length;)e=t.shift(),delete n[e[r]],s++;return t}function u(e){var t=this;if(e)for(var r=0;r<t.length;)e(t[r],r),r++;return t}function d(e,t){var r=this;return e=e||this.key,r.sort(function(r,n){var s=t?n:r,o=t?r:n;return s[e]-o[e]}),r}function p(e){return this.forward(e,!0)}function f(e){if(e.key!==this.key||e.length!==this.length)return!0;for(var t=!1,r=0,n=this.length,s=this.key;t&&r<n;)t=this[r][s]!==e[r][s],r++}function m(){var e=this,t=this.pool,r=this.key;Object.keys(t).forEach(function(e){delete t[e]}),angular.forEach(e,function(e){t[e[r]]=e})}var h={};return e.get=function(e){return h[e]=h[e]||{}},e.prototype=new Array,e.prototype.has=t,e.prototype.getId=r,e.prototype.get=n,e.prototype.set=s,e.prototype.add=o,e.prototype.remove=i,e.prototype.each=u,e.prototype.addMany=a,e.prototype.removeMany=l,e.prototype.removeAll=c,e.prototype.forward=d,e.prototype.backward=p,e.prototype.differs=f,e.prototype.updatePool=m,e}]),app.factory("Calendar",["Hash",function(e){function t(e,t){for(var r=[];r.length<e;)r.push(t(r.length));return r}function r(){}var n=new Date;n.setHours(0),n.setMinutes(0),n.setSeconds(0);var s=Math.ceil(n.getTime()/864e5),o=new e("mKey");return r.getDate=function(e){return"function"==typeof e.date.getMonth?e.date:new Date(e.date)},r.clearMonth=function(e){e.days.each(function(e){e&&(e.hours=0,e.tasks=[])})},r.getMonth=function(i){n=new Date,n.setHours(0),n.setMinutes(0),n.setSeconds(0),s=Math.ceil(n.getTime()/864e5);var a=r.getDate(i),l=a.getFullYear(),c=a.getMonth(),u=(Math.ceil(a.getTime()/864e5),12*l+c),d=o.getId(u);if(!d){var p=new Date(l,c,1).getDay(),f=new Date(l,c+1,0).getDate(),m=Math.ceil(f/7);d={date:a,mKey:u,month:c,monthDays:f,fromDay:p,days:new e("key")},d.weeks=t(m,function(e){var r=t(7,function(t){var r=null,n=7*e+t-(p-1);if(n>=0&&n<f){var o=new Date(l,c,n+1),i=Math.ceil(o.getTime()/864e5);r={$today:i===s,c:t,r:e,d:n+1,date:o,key:i,hours:0,tasks:[]},r=d.days.add(r)}return r});return{r:e,days:r}}),d=o.add(d)}return d},r.getDay=function(e){var t=new Date(n);return t.setDate(t.getDate()+e),t},r.getKey=function(e){return Math.ceil(e.getTime()/864e5)},r}]),app.factory("GanttRow",["Hash","Calendar","ganttGroups",function(e,t,r){function n(t,n){this.type=r.ACTIVITY,this.assignedHours=0,this.slots=new e("id"),this.days=new e("key"),this.months=new e("mKey"),this.ranges=new e("rKey"),this.tasks=new e("id"),t&&(this.id=t.activity.id,this.name=t.activity.name,this.budgetHours=t.activity.budgetHours,this.useBudget=2!==t.project.type&&4!==t.project.type,this.customer=t.customer,this.department=t.department,this.manager=t.manager,this.project=t.project,this.resource=t.resource,this.color=n[this.id%(n.length||1)]),this.lastTaskId=null,this.update()}var s=1,o=new Date;o.setHours(0),o.setMinutes(0),o.setSeconds(0);var i=Math.ceil(o.getTime()/864e5);return n.prototype={canSelect:function(){return this.type===r.ACTIVITY&&this.budgetHours>0},canEdit:function(){return this.canSelect()&&-1===this.resource.name.toLowerCase().indexOf("nondefinito")},mergeSlot:function(e){var t=this.slots;e.hours?t.add(e):t.remove(e)},insertSlot:function(e,t,r){var n=null;if(this.useBudget&&(t=Math.min(t,this.budgetHours-this.assignedHours)),(t=Math.max(0,t))>0){var o={id:"temp-"+s++,key:e,date:new Date(864e5*e),hours:t,activityId:this.id};r&&(o.taskId=r,this.lastTaskId=r),this.slots.add(o),n=this.slots.getId(o.id)}return this.update(),n},removeSlots:function(e){var t=this.days.getId(e);t.tasks.each(function(e){e.hours=0});var r=t.tasks.slice();return this.slots.removeMany(r),this.update(),r},toggleSlots:function(e,t){return this.days.has(e)?this.removeSlots(e):[this.insertSlot(e,t,this.lastTaskId)]},assign:function(e,t){console.log("assign");var r=this.slots,n=e.$key,o={id:"temp-"+s++,key:n,date:e.$date,hours:t||0,activityId:this.id};return t?r.add(o):r.remove(o),this.update(),this.days.getId(n)},write:function(e,t,r){if(t=Math.min(t,r),this.useBudget&&(t=Math.min(t,this.budgetHours-this.assignedHours)),(t=Math.max(0,t))&&!this.days.has(e.$key)&&e.$date>=o)return this.assign(e,t)},erase:function(e,t,r){if(this.days.has(e.$key)&&e.$date>=o)return this.assign(e,null)},toggle:function(e,t,r){return this.days.has(e.$key)?this.erase(e,t,r):this.write(e,t,r)},update:function(){var t=0,r=this.slots,n=this.days;n.removeAll();var s=null;r.each(function(r){s=r.taskId||s,t+=r?r.hours:0;var o=n.add({key:r.key,date:r.date,hours:0});o.tasks=o.tasks||new e("id"),o.tasks.add(angular.copy(r)),o.tasks.each(function(e){o.hours+=e.hours})}),this.lastTaskId=s||this.lastTaskId,n.forward(),this.assignedHours=t,this.updateRanges()},updateMonths:function(){var e=this.days,r=this.months;r.removeAll();var n;e.each(function(e){var s=t.getMonth(e);s!==n&&(n=s,t.clearMonth(s)),r.add(s);var o=s.days.getId(e.key);o&&(o.hours=e.hours,o.tasks=e.tasks)}),r.forward()},updateRanges:function(){var e=this.days,t=this.ranges;t.removeAll();var r,n=0;e.each(function(e,s){r&&(e.key-r.key>1||e.tasks.differs(r.tasks))&&n++,r=e;var o=t.add({rKey:n});o.days=o.days||[],o.days.push(e.key)}),t.forward()},getRange:function(e,t,r){var n=this.ranges,s=null,o=e.$key;return n.each(function(e){var n=e.days.indexOf(o);-1!==n&&(e.c=n,e.firstKey=Math.max(t,e.days[0]),e.lastKey=Math.min(r,e.days[e.days.length-1]),s=e)}),s},updateRange:function(e,t,r){var n=this.ranges,s=this.getRange(e,t,r);if(s){s.previousKey=null,s.nextKey=null;var o=s.rKey;if(o>0){var i=n[o-1];s.previousKey=i.days[i.days.length-1]}if(o<n.length-1){var a=n[o+1];s.nextKey=a.days[0]}}return s},canMoveRange:function(e,t){for(var r=!0,n=this,s=e.items[0],o=(e.items[e.items.length-1],n.getOffsetKey(s.startDate,t)),a=0,l=e.items.length;a<l;){var c=o+a;(c<i||n.days.getId(c)&&-1===e.items.indexOf(n.days.getId(c)))&&(r=!1,a=l),a++}return r},moveRange:function(e,t){if(e.items.length){var r=this;r.canMoveRange(e,t)&&(angular.forEach(e.items,function(e){r.addDays(e,t)}),r.update())}},addDays:function(e,t){var r=new Date(e.startDate);return r.setDate(r.getDate()+t),e.date=r,e.key=Math.ceil(r.getTime()/864e5),e},getOffsetKey:function(e,t){return e=new Date(e),e.setDate(e.getDate()+t),Math.ceil(e.getTime()/864e5)},getHours:function(e){var t=0,r=this.days.getId(e);return r&&r.tasks.each(function(e){t+=e.hours}),t},toggleOpened:function(){this.opened=!this.opened},compress:function(e){if(this.items.length){this.items.sort(function(e,t){return e.key-t.key});var t=Utils.where(this.items,{key:e});t=t||this.items[0];var r=this.items.indexOf(t),n=r,s=this.items.length;for(e=Math.max(e,i);n<s;)t=this.items[n],t.key=e+n-r,t.date=new Date(864e5*t.key),n++;this.update()}}},n.serialNumber=function(e,t){return new Array(1+t.toString().length-e.toString().length).join("0")},n}]),app.directive("header",[function(){return{restrict:"E",templateUrl:"partials/header",transclude:{header:"?headerItems"},link:function(e,t,r,n){}}}]),app.directive("controlMessages",[function(){return{restrict:"E",templateUrl:"partials/control-messages",transclude:{message:"?messageItems"},link:function(e,t,r,n){}}}]),app.directive("control",["$http","$templateCache","$compile","$parse",function(e,t,r,n){function s(e,t,r){e=e||"",t=t||"";var n=e.split(",");if(n.length>1){var s=n.shift();return angular.forEach(n,function(e,n){s=r?s.split("{"+n+"}").join("' + "+t+e+" + '"):s.split("{"+n+"}").join(t+e)}),r?"'"+s+"'":s}return t+e}var o=0;return{restrict:"A",templateUrl:function(e,t){var r="partials/control";switch(t.control){case"select":r="partials/control-select"}return r},scope:{ngModel:"=",required:"=",form:"@",title:"@",placeholder:"@"},require:"ngModel",link:function(e,t,r,n){},compile:function(e,t){return{pre:function(e,t,r){if("select"===r.control){var i=r.label?r.label:"name",a=r.key?r.key:"id",l=r.min?" | filter:gte('"+a+"', "+r.min+")":"",c=s(i,"item.",!0);e.options=r.number?"item."+a+" as "+c+" disable when item.disabled for item in "+r.source+l:c+" disable when item.disabled for item in "+r.source+l+" track by item."+a,console.log("control.compile.pre",e.options)}var u=(e.type=r.control,e.form=e.form||"form",e.title=e.title||"untitled");e.placeholder=e.placeholder||u,e.field=u.replace(/[^0-9a-zA-Z]/g,"").split(" ").join("")+ ++o;e.minLength=r.min||0,e.maxLength=r.max||Number.POSITIVE_INFINITY,e.focus=!1,e.getType=function(){var t="text";switch(r.control){case"password":t=e.visible?"text":"password";break;default:t=r.control}return console.log("control.getType",t),t},e.getClasses=function(){var t=n(e.form)(e.$parent),r=n(e.form+"."+e.field)(e.$parent);return{"control-focus":e.focus,"control-success":r.$valid,"control-error":r.$invalid&&(t.$submitted||r.$touched),"control-empty":!r.$viewValue}},e.getMessages=function(){var t=n(e.form)(e.$parent),r=n(e.form+"."+e.field)(e.$parent);return(t.$submitted||r.$touched)&&r.$error}}}}}}]),app.directive("state",["$timeout",function(e){return{restrict:"EA",templateUrl:"partials/state",transclude:!0,replace:!0,scope:{state:"="},link:function(t,r,n,s){function o(){e(function(){if(!t.$parent.$eval(n.onValidate))return t.state.button=r,t.$parent.$eval(n.onClick);t.$parent.$eval("form.$setSubmitted()")})}function i(){r.off("touchstart click",o)}t.stateClass=function(){if(t.state.button===r){return{busy:t.state.isBusy,successing:t.state.isSuccessing,success:t.state.isSuccess,errorring:t.state.isErroring,error:t.state.isError}}return null},t.stateDisabled=function(){return t.state.button&&t.state.button!==r},t.$on("$destroy",function(){i()}),function(){r.on("touchstart click",o)}()}}}]),app.directive("controlRow",["$http","$templateCache","$compile",function(e,t,r){function n(e,t,r){e=e||"",t=t||"";var n=e.split(",");if(n.length>1){var s=n.shift();return angular.forEach(n,function(e,n){s=r?s.split("{"+n+"}").join("' + "+t+e+" + '"):s.split("{"+n+"}").join(t+e)}),r?"'"+s+"'":s}return t+e}function s(e,t){var r=t.form||"Form",s=t.title||"Untitled",i=t.placeholder||s,a=s.replace(/[^0-9a-zA-Z]/g,"").split(" ").join("")+ ++o,l=r+"."+a,c=' ng-focus="'+l+'.hasFocus=true" ng-blur="'+l+'.hasFocus=false"',u="",d="",p="",f=t.label?t.label:"name",m=t.key?t.key:"id",h=t.model,g=t.onChange?' ng-change="'+t.onChange+'"':"",v=t.onFocus?' ng-focus="'+t.onFocus+'"':"",y=t.onBlur?' ng-blur="'+t.onBlur+'"':"",b=t.cols?6:9,$="col-lg-"+b,k="col-lg-"+(12-b);"12"===t.cols&&(k=$="col-lg-12");var w=t.required?' required="true"':"",S=t.readonly?" readonly":"",M=t.options?' ng-model-options="'+t.options+'" ':"",I=t.validate?' validate-type="'+t.validate+'" ':"",E=t.format?' format="'+t.format+'" ':"",x=t.precision?' precision="'+t.precision+'" ':"";switch(t.disabled&&(p=" disabled"),t.ngDisabled&&(p=' ng-disabled="'+t.ngDisabled+'"'),t.required&&(d=t.readonly||t.disabled?"":"<sup>âœ½</sup>"),u='<span ng-messages="'+(t.readonly?"":"("+r+".$submitted || "+l+".$touched) && ")+l+'.$error" role="alert">',u+='<span ng-message="required" class="label-error animated flash">obbligatorio â¤´</span>',t.controlRow){case"password":u+='<span ng-message="minlength" class="label-error animated flash">almeno 6 caratteri â¤´</span>';break;case"email":u+='<span ng-message="email" class="label-error animated flash">valore non corretto â¤´</span>';break;case"number":case"range":u+='<span ng-message="positive" class="label-error animated flash">solo valori positivi â¤´</span>',u+='<span ng-message="number" class="label-error animated flash">solo valori numerici â¤´</span>'}void 0!==t.match&&(u+='<span ng-message="match" class="label-error animated flash">non corrispondente â¤´</span>'),u+="</span>";var A=" ng-class=\"{ 'control-focus': "+l+".hasFocus, 'control-success': "+l+".$valid, 'control-error': "+l+".$invalid && ("+r+".$submitted || "+l+".$touched), 'control-empty': !"+l+'.$viewValue }"',D='<div class="row" '+A+'><label for="'+a+'" class="'+k+' col-form-label">'+s+d+'</label><div class="'+$+" col-"+t.controlRow+'">';switch(t.controlRow){case"static":D+='<p class="form-control" '+(t.click?' ng-click="'+t.click+'"':"")+(t.mouseover?' ng-mouseover="'+t.mouseover+'"':"")+(t.mouseout?' ng-mouseover="'+t.mouseout+'"':"")+'><span ng-bind-html="'+h+" || '&nbsp;'\"></span>"+(t.icon?'<i class="pull-xs-right '+t.icon+'"></i>':"")+"</p>";break;case"checkbox":D='<div class="'+$+'"'+A+'><div class="col-xs-12"><label class="custom-control custom-checkbox">',D+='   <input type="checkbox" class="custom-control-input" ng-model="'+h+'">',D+='   <span class="custom-control-indicator"></span>',D+='   <span class="custom-control-description">'+s+"</span>",D+="</label>";break;case"yesno":D='<div class="row" '+A+'><label class="col-lg-6 custom-control custom-checkbox">'+s+d+"</label>",D+='<div class="'+k+'"><label class="custom-control custom-checkbox">',D+='   <input type="checkbox" class="custom-control-input" ng-model="'+h+'" ng-change="'+h+"No=!"+h+'">',D+='   <span class="custom-control-indicator"></span>',D+='   <span class="custom-control-description">SÃ¬</span>',D+="</label></div>",D+='<div class="'+k+'"><label class="custom-control custom-checkbox">',D+='   <input type="checkbox" class="custom-control-input" ng-model="'+h+'No" ng-change="'+h+"=!"+h+'No">',D+='   <span class="custom-control-indicator"></span>',D+='   <span class="custom-control-description">No</span>',D+="</label>";break;case"switch":t.disabled&&(p=' disabled="true"'),t.ngDisabled&&(p=' disabled="'+t.ngDisabled+'"'),D='<div class="row control-switch" '+A+'><label for="'+a+'" class="'+k+' col-form-label">'+s+d+"</label>",D+='<div class="'+$+'">',D+='<switch name="'+a+'" ng-model="'+h+'" '+g+v+y+M+' on="SÃ¬" off="No" '+w+p+S+c+"></switch>";break;case"range":I=' validate-type="number"';var T=a+"Hi",N=r+"."+T,O=t.modelHi,j=" ng-class=\"{ 'control-focus': "+N+".hasFocus, 'control-success': "+N+".$valid, 'control-error': "+N+".$invalid && ("+r+".$submitted || "+N+".$touched), 'control-empty': !"+N+'.$viewValue }"',C=w;"true"==t.requiredHi?C=' required="true"':"false"==t.requiredHi&&(C="");var q=" ",U=" ";switch(t.required&&"false"!==t.requiredHi&&(U=t.readonly||t.disabled?"":"<sup>âœ½</sup>"),q='<span ng-messages="'+(t.readonly?"":"("+r+".$submitted || "+N+".$touched) && ")+N+'.$error" role="alert">',q+='<span ng-message="required" class="label-error animated flash">obbligatorio â¤´</span>',t.controlRow){case"password":q+='<span ng-message="minlength" class="label-error animated flash">almeno 3 caratteri â¤´</span>';break;case"email":q+='<span ng-message="email" class="label-error animated flash">valore non corretto â¤´</span>';break;case"number":case"range":q+='<span ng-message="positive" class="label-error animated flash">solo valori positivi â¤´</span>',q+='<span ng-message="number" class="label-error animated flash">solo valori numerici â¤´</span>'}return void 0!==t.match&&(q+='<span ng-message="match" class="label-error animated flash">non corrispondente â¤´</span>'),q+="</span>",D='<div class="row"><label for="'+a+'" class="'+k+' col-form-label">'+s+'</label><div class="'+$+" col-"+t.controlRow+'">',D+='<div class="form-control-range form-control-range-min" '+A+">"+d+'<input class="form-control" name="'+a+'" ng-model="'+h+'" '+g+v+y+M+' placeholder="'+i+'" type="text"'+w+p+S+c+I+E+x+">"+u+"</div>",(D+='<div class="form-control-range form-control-range-max" '+j+">"+U+'<input class="form-control" name="'+T+'" ng-model="'+O+'" '+g+v+y+M+' placeholder="'+i+'" type="text"'+C+p+S+c+I+E+x+">"+q+"</div>")+"</div></div>";case"range-slider":var F=t.himodel?' rz-slider-high="'+t.himodel+'" ':"";M=t.options?' rz-slider-options="'+t.options+'" ':"",D+='<rzslider rz-slider-model="'+h+'" '+F+M+'"></rzslider>';break;case"select":var R=t.min?" | filter:gte('"+m+"', "+t.min+")":"",V=n(f,"item.",!0),M=t.number?"item."+m+" as "+V+" disable when item.disabled for item in "+t.source+R:V+" disable when item.disabled for item in "+t.source+R+" track by item."+m;D+='<select name="'+a+'" class="form-control" ng-model="'+h+'" '+g+v+y+' ng-options="'+M+'" '+(t.number?"convert-to-number":"")+w+p+'><option value="" disabled selected hidden>'+i+"</option></select>";break;case"autocomplete":var H=!!t.canCreate&&t.canCreate,P=!!t.flatten&&t.flatten,B=!!t.queryable&&t.queryable,K=t.onSelected?' on-selected="'+t.onSelected+'"':"";D+='<input name="'+a+'" ng-model="'+h+'" type="hidden" '+(t.required?"required":"")+">",D+='<div control-autocomplete="'+t.source+'" model="'+h+'" label="'+f+'"  key="'+m+'" can-create="'+H+'" flatten="'+P+'" queryable="'+B+'" placeholder="'+i+'" on-focus="'+l+'.hasFocus=true" on-blur="'+l+'.hasFocus=false"'+K+"></div>";break;case"textarea":D+='<textarea name="'+a+'" class="form-control" ng-model="'+h+'" '+g+v+y+M+' placeholder="'+i+'" '+w+p+' rows="'+(t.rows?t.rows:"1")+'"'+c+"></textarea>";break;case"htmltext":var z="";t.disabled&&(z=' ta-disabled="true"'),t.ngDisabled&&(z=' ta-disabled="'+t.ngDisabled+'"'),D+='<div text-angular name="'+a+'" ta-paste="doStripHtml($html)" ng-model="'+h+'" '+g+v+y+M+' placeholder="'+i+'" '+w+z+S+c+(t.required?' ta-min-text="1"':"")+"></div>";break;case"password":D+='<div class="input-group"><input name="'+a+'" class="form-control" ng-model="'+h+'" '+g+v+y+M+' placeholder="'+i+'" type="{{form.'+a+" ? 'password' : 'text'}}\" ng-minlength=\"6\" "+w+p+c+'><span class="input-group-addon" ng-if="'+h+'"><span class="icon-eye" ng-click="form.'+a+" = !form."+a+'"></span></span></div>';break;case"email":D+='<input name="'+a+'" class="form-control" ng-model="'+h+'" '+g+v+y+M+' placeholder="'+i+'" type="email" '+w+p+c+">";break;case"number-picker":I=' validate-type="anynumber"',D+='<div number-picker="'+h+'" min="'+t.min+'" max="'+t.max+'">',D+='   <input name="'+a+'" class="form-control" ng-model="'+h+'" '+g+v+y+M+' placeholder="'+i+'" type="text"'+w+p+S+c+I+E+x+">",D+="</div>";break;case"number":I=' validate-type="number"',D+='<input name="'+a+'" class="form-control" ng-model="'+h+'" '+g+v+y+M+' placeholder="'+i+'" type="text"'+w+p+S+c+I+E+x+">";break;case"anynumber":I=' validate-type="anynumber"',D+='<input name="'+a+'" class="form-control" ng-model="'+h+'" '+g+v+y+M+' placeholder="'+i+'" type="text"'+w+p+S+c+I+E+x+">";break;case"date":I=' validate-type="date"',E=' format="dd-MM-yyyy"',t.disabled||t.readonly?D+='<div class="input-group"><input type="text" class="form-control" name="'+a+'" ng-model="'+h+'" placeholder="'+i+'" '+w+p+S+c+I+E+'><span class="input-group-addon"><i class="icon-calendar"></i></span></div>':(D+='<input type="date" name="'+a+'" class="form-control form-control-hidden" is-open="flags.'+a+'" ng-model="'+h+'" placeholder="dd-MM-yyyy" '+w+p+S+c+' uib-datepicker-popup datepicker-options="sources.datepickerOptions" datepicker-template-url="uib/template/datepicker/datepicker.html" show-button-bar="false" current-text="Oggi" clear-text="Rimuovi" close-text="Chiudi">',D+='<div ng-click="(flags.'+a+' = true)" class="input-group disabled"><input type="text" class="form-control" name="'+a+'" ng-model="'+h+'" placeholder="'+i+'" '+w+p+S+c+I+E+'><span class="input-group-addon"><i class="icon-calendar"></i></span></div>');break;case"datetime-local":i=i||"dd-MM-yyyyTHH:mm:ss",D+='<input name="'+a+'" class="form-control" ng-model="'+h+'" '+g+v+y+M+' placeholder="'+i+'" type="datetime-local"'+w+p+S+c+">";break;case"text":default:D+='<input name="'+a+'" class="form-control" ng-model="'+h+'" '+g+v+y+M+' placeholder="'+i+'" type="text"'+w+p+S+c+I+E+x+">"}return D+u+"</div></div>"}var o=0;return{restrict:"A",replace:!0,compile:function(e,t){return function(n,o,i){o.html(s(e,t)),r(o.contents())(n)}}}}]),app.directive("numberPicker",["$parse","$timeout",function(e,t){return{restrict:"A",template:'<div class="input-group">   <span class="input-group-btn"><button class="btn btn-outline-primary" type="button">-</button></span>   <div ng-transclude></div>   <span class="input-group-btn"><button class="btn btn-outline-primary" type="button">+</button></span></div>',replace:!0,transclude:!0,link:function(r,n,s,o){function i(n){var o=e(s.min)(r),i=e(s.numberPicker),a=i.assign;t(function(){a(r,Math.max(o,i(r)-1))})}function a(n){var o=e(s.max)(r),i=e(s.numberPicker),a=i.assign;t(function(){a(r,Math.min(o,i(r)+1))})}function l(){angular.element(u).off("touchstart mousedown",i),angular.element(d).off("touchstart mousedown",a)}var c=n[0],u=c.querySelectorAll(".input-group-btn > .btn")[0],d=c.querySelectorAll(".input-group-btn > .btn")[1];r.$on("$destroy",function(){l()}),function(){angular.element(u).on("touchstart mousedown",i),angular.element(d).on("touchstart mousedown",a)}()}}}]),app.directive("validateType",["$filter",function(e){return{require:"ngModel",link:function(t,r,n,s){function o(){p=!0,u&&(r[0].value=s.$modelValue||null,s.$modelValue||s.$setViewValue(null))}function i(){if(u&&!s.$invalid)switch(c){case"date":case"datetime":case"datetime-local":r[0].value=s.$modelValue?e("date")(s.$modelValue,u):" ";break;default:r[0].value=s.$modelValue?e("number")(s.$modelValue,d)+" "+u:" "}}function a(){p=!1,i()}function l(){r.off("focus",o),r.off("blur",a)}var c=n.validateType,u=n.format||"",d=n.precision||2,p=!1;switch(c){case"date":case"datetime":case"datetime-local":s.$formatters.push(function(t){return t?e("date")(t,u):null});break;case"number":s.$parsers.unshift(function(e){var t=!1;return void 0!==e&&""!==e?(t=-1!==String(e).indexOf(Number(e).toString()),e=Number(e),s.$setValidity("number",t),t&&(s.$setValidity("positive",e>=.01),void 0!==n.min&&s.$setValidity("range",e>=Number(n.min)),void 0!==n.max&&s.$setValidity("range",e<=Number(n.max)))):(t=!0,e=Number(e),s.$setValidity("number",!0),s.$setValidity("positive",!0),void 0!==n.min&&s.$setValidity("range",!0),void 0!==n.max&&s.$setValidity("range",!0)),e}),s.$formatters.push(function(t){return t?e("number")(t,d)+" "+u:null});break;case"anynumber":s.$parsers.unshift(function(e){var t=!1;return void 0!==e&&""!==e?(t=-1!==String(e).indexOf(Number(e).toString()),e=Number(e),s.$setValidity("number",t),t&&(void 0!==n.min&&s.$setValidity("range",e>=Number(n.min)),void 0!==n.max&&s.$setValidity("range",e<=Number(n.max)))):(t=!0,e=Number(e),s.$setValidity("number",!0),void 0!==n.min&&s.$setValidity("range",!0),void 0!==n.max&&s.$setValidity("range",!0)),e}),s.$formatters.push(function(t){return t||0===t?e("number")(t,d)+" "+u:null})}t.$on("$destroy",function(){l()}),function(){r.on("focus",o),r.on("blur",a)}()}}}]),app.factory("State",["$timeout",function(e){function t(){this.isReady=!1,this.idle()}return t.prototype={idle:function(){this.isBusy=!1,this.isError=!1,this.isErroring=!1,this.isSuccess=!1,this.isSuccessing=!1,this.button=null,this.errors=[]},enabled:function(){return!this.isBusy&&!this.isErroring&&!this.isSuccessing},busy:function(){return!this.isBusy&&(this.isBusy=!0,this.isError=!1,this.isErroring=!1,this.isSuccess=!1,this.isSuccessing=!1,this.errors=[],!0)},success:function(){this.isBusy=!1,this.isError=!1,this.isErroring=!1,this.isSuccess=!0,this.isSuccessing=!0,this.errors=[],e(function(){this.isSuccessing=!1,this.button=null}.bind(this),1e3)},error:function(t){this.isBusy=!1,this.isError=!0,this.isErroring=!0,this.isSuccess=!1,this.isSuccessing=!1,this.errors.push(t),e(function(){this.isErroring=!1,this.button=null}.bind(this),1e3)},ready:function(){this.isReady=!0,this.success()},errorMessage:function(){return this.isError?this.errors[this.errors.length-1]:null},submitClass:function(){return{busy:this.isBusy,ready:this.isReady,successing:this.isSuccessing,success:this.isSuccess,errorring:this.isErroring,error:this.isError}},submitMessage:function(e,t,r,n){return e=e||"Submit",this.isBusy?t||e:this.isSuccess?r||e:this.isError?n||e:e}},t}]),app.factory("User",["$q","$location","LocalStorage","Api",function(e,t,r,n){function s(e){e&&angular.extend(this,e)}return s.prototype={},s.current=function(){return r.get("user")},s.isLoggedOrGoTo=function(s){function o(e){r.set("q",window.btoa(JSON.stringify({un:e.userName,pwd:e.password}))),e.password=null,r.set("user",{id:e.id}),a.resolve(e)}function i(e){a.reject(e),t.$$lastRequestedPath=t.path(),t.path(s)}var a=e.defer(),l=r.get("q");return l?n.auth.sso(l).then(o,i):n.auth.current().then(o,i),a.promise},s.signin=function(t){var s=e.defer();return n.auth.signin(t).then(function(e){r.set("q",window.btoa(JSON.stringify({un:e.userName,pwd:e.password}))),e.password=null,r.set("user",{id:e.id}),s.resolve(e)},function(e){s.reject(e)}),s.promise},s.signout=function(){var t=e.defer(),s=r.get("user");return s?n.auth.signout(s.id).then(function(e){r.delete("q"),r.delete("user"),t.resolve(e)},function(e){t.reject(e)}):t.reject(null),t.promise},s}]),app.service("FirebaseApi",["$q","$firebaseAuth","$firebaseObject","$firebaseArray",function(e,t,r,n){function s(e,t,r){var n={};void 0===r&&(r=e.length);for(var s=t;s<r;++s)n[e.$keyAt(s)]=null;return e.$ref().update(n)}var o=this,i=window.firebase||null;if(!i)throw"missing firebase.js";var a={apiKey:"AIzaSyCskd8Cgzd_j7JzgEC3mEb4ir1qZFh6auQ",authDomain:"starfish-c2b0f.firebaseapp.com",databaseURL:"https://starfish-c2b0f.firebaseio.com",projectId:"starfish-c2b0f",storageBucket:"starfish-c2b0f.appspot.com",messagingSenderId:"796739915579"};i.initializeApp(a),this.auth={connect:function(){var r=e.defer();if(o.presence)r.resolve(o.presence);else{var n=o.presence={id:random,name:"Firebase "+random,firstName:"Firebase",lastName:random};(o.auth=t()).$signInAnonymously({remember:"sessionOnly"}).then(function(e){n.uid=e.uid,console.log("connecting",n),r.resolve(n)}).catch(function(e){console.log("Error",e),r.reject(e)})}return r.promise},current:function(){var t=e.defer();return o.user?t.resolve(o.user):t.reject(),t.promise},signin:function(r){console.log("FirebaseService.signin",r);var n=e.defer();if(o.user)console.log("Signed in as",o.user),n.resolve(o.user);else{var s=1e4+Math.floor(1e3*Math.random()),i=o.user={id:s,name:"Firebase "+s,firstName:"Firebase",lastName:s};if(r)for(var a in i)i[a]=r[a]||i[a];i.timestamp=Date.now();(o.auth=t()).$signInAnonymously({remember:"sessionOnly"}).then(function(e){i.uid=e.uid,console.log("Signed in as",i),n.resolve(i)}).catch(function(e){console.log("Error",e),n.reject(e)})}return n.promise},signup:function(r){console.log("FirebaseService.signin",r);var n=e.defer();if(o.user)console.log("Signed in as",o.user),n.resolve(o.user);else{var s=1e4+Math.floor(1e3*Math.random()),i=o.user={id:s,name:"Firebase "+s,firstName:"Firebase",lastName:s};if(r)for(var a in i)i[a]=r[a]||i[a];i.timestamp=Date.now();(o.auth=t()).$signInAnonymously({remember:"sessionOnly"}).then(function(e){i.uid=e.uid,console.log("Signed in as",i),n.resolve(i)}).catch(function(e){console.log("Error",e),n.reject(e)})}return n.promise}},this.presences={getPresences:function(){var t=e.defer(),r=o.user,s=o.root=i.database().ref(),a=s.child("presences"),l=a.push();return s.child(".info/connected").on("value",function(e){e.val()&&(l.onDisconnect().remove(),l.set(r),
o.updateUser=function(){l.set(r)},t.resolve())}),a.on("value",function(e){var t=e.val(),r=[];for(var n in t){var s=t[n];s.id!==o.user.id&&r.push(s)}r.length&&o.options.onPresences(r)}),o.presences=n(a),t.promise}},this.activities={clearActivities:function(){var e=Number.POSITIVE_INFINITY;angular.forEach(o.presences,function(t){e=Math.min(t.timestamp,e)});var t=o.activities,r=0;angular.forEach(t,function(t,n){t.timestamp<e&&(r=n+1)}),s(t,0,r)},addActivities:function(e){if(e&&e.length){var t=o.user,r=o.root,n=null,s=r.child("activities");angular.forEach(e,function(e){e.userId=t.id,e.timestamp=Date.now(),n=e,s.push().set(e)}),n&&(t.lastActivity=n,o.updateUser())}},getUniqueActivities:function(e){e.sort(function(e,t){return t.timestamp-e.timestamp});var t={};return e=e.filter(function(e){return!t[e.id]&&(t[e.id]=!0)}),e.sort(function(e,t){return e.timestamp-t.timestamp}),e},getActivities:function(){var t=e.defer(),r=o.root,s=r.child("activities"),i=o.user,a=i.timestamp;return s.on("value",function(e){var t=e.val(),r=[],n=Number.NEGATIVE_INFINITY;for(var s in t){var i=t[s];n=Math.max(n,i.timestamp),i.userId!==o.user.id&&i.timestamp>a&&r.push(i)}a=Math.max(a,n),r=o.getUniqueActivities(r),r.length&&o.options.onActivities(r)}),(o.activities=n(s)).$loaded().then(function(){o.clearActivities(),t.resolve()}).catch(function(e){t.reject(e)}),t.promise}}}]),app.service("WebApi",["$http","$q","$timeout","$location",function(e,t,r,n){var s=this;this.get=function(r,n){var s=t.defer();return e.get(r,{params:n}).then(function(e){s.resolve(e.data)},function(e){onError(s,"get",r,{params:n},e)}),s.promise},this.post=function(r,n){var o=t.defer();return s.DEBUG?(console.log("Api.DEBUG",r,n),o.resolve(n)):e.post(r,n).then(function(e){o.resolve(e.data)},function(e){onError(o,"post",r,n,e)}),o.promise},this.put=function(r,n){var s=t.defer();return e.put(r,n).then(function(e){s.resolve(e.data)},function(e){onError(s,"put",r,n,e)}),s.promise},this.patch=function(r,n){var s=t.defer();return e.patch(r,n).then(function(e){s.resolve(e.data)},function(e){onError(s,"patch",r,n,e)}),s.promise},this.delete=function(r){var n=t.defer();return e.delete(r).then(function(e){n.resolve(e.data)},function(e){onError(n,"delete",r,null,e)}),n.promise},this.blob=function(r,n){var o=t.defer();return s.DEBUG?(console.log("Api.DEBUG",r,n),o.resolve(n)):e({url:r,method:"POST",data:n,headers:{"Content-type":"application/json"},responseType:"arraybuffer"}).then(function(e){o.resolve(e)},function(e){onError(o,"post",r,n,e)}),o.promise};this.auth={signin:_service.signin,signout:function(e){},current:function(){var e=t.defer();return _service.user?e.resolve(_service.user):e.reject(),e.promise}}}]),app.factory("FirebaseService",["$q","$firebaseAuth","$firebaseObject","$firebaseArray",function(e,t,r,n){function s(){return c||(c={apiKey:"AIzaSyCskd8Cgzd_j7JzgEC3mEb4ir1qZFh6auQ",authDomain:"starfish-c2b0f.firebaseapp.com",databaseURL:"https://starfish-c2b0f.firebaseio.com",projectId:"starfish-c2b0f",storageBucket:"starfish-c2b0f.appspot.com",messagingSenderId:"796739915579"},l.initializeApp(c)),c}function o(e){var t={onPresences:function(e){console.log("FirebaseService.onPresences",e.length)},onActivities:function(e){console.log("FirebaseService.onActivities",e.length)}};this.options=e?angular.extend(t,e):t,this.config=s()}function i(e,t,r){var n={};void 0===r&&(r=e.length);for(var s=t;s<r;++s)n[e.$keyAt(s)]=null;return e.$ref().update(n)}var a=this,l=window.firebase||null;if(!l)throw"missing firebase.js";var c=null;return o.prototype={signin:function(r){console.log("FirebaseService.signin",r);var n=e.defer();if(this.user)console.log("Signed in as",this.user),n.resolve(this.user);else{var s=1e4+Math.floor(1e3*Math.random()),o=this.user={id:s,name:"Firebase "+s,firstName:"Firebase",lastName:s};if(r)for(var i in o)o[i]=r[i]||o[i];o.timestamp=Date.now();(this.auth=t()).$signInAnonymously({remember:"sessionOnly"}).then(function(e){o.uid=e.uid,console.log("Signed in as",o),n.resolve(o)}).catch(function(e){console.log("Error",e),n.reject(e)})}return n.promise},getPresences:function(){var t=e.defer(),r=this.user,s=this.root=l.database().ref(),o=s.child("presences"),i=o.push();return s.child(".info/connected").on("value",function(e){e.val()&&(i.onDisconnect().remove(),i.set(r),a.updateUser=function(){i.set(r)},t.resolve())}),o.on("value",function(e){var t=e.val(),r=[];for(var n in t){var s=t[n];s.id!==a.user.id&&r.push(s)}r.length&&a.options.onPresences(r)}),this.presences=n(o),t.promise},clearActivities:function(){var e=Number.POSITIVE_INFINITY;angular.forEach(this.presences,function(t){e=Math.min(t.timestamp,e)});var t=this.activities,r=0;angular.forEach(t,function(t,n){t.timestamp<e&&(r=n+1)}),i(t,0,r)},addActivities:function(e){if(e&&e.length){var t=this.user,r=this.root,n=null,s=r.child("activities");angular.forEach(e,function(e){e.userId=t.id,e.timestamp=Date.now(),n=e,s.push().set(e)}),n&&(t.lastActivity=n,a.updateUser())}},getUniqueActivities:function(e){e.sort(function(e,t){return t.timestamp-e.timestamp});var t={};return e=e.filter(function(e){return!t[e.id]&&(t[e.id]=!0)}),e.sort(function(e,t){return e.timestamp-t.timestamp}),e},getActivities:function(){var t=e.defer(),r=this.root,s=r.child("activities"),o=this.user,i=o.timestamp;return s.on("value",function(e){var t=e.val(),r=[],n=Number.NEGATIVE_INFINITY;for(var s in t){var o=t[s];n=Math.max(n,o.timestamp),o.userId!==a.user.id&&o.timestamp>i&&r.push(o)}i=Math.max(i,n),r=a.getUniqueActivities(r),r.length&&a.options.onActivities(r)}),(this.activities=n(s)).$loaded().then(function(){a.clearActivities(),t.resolve()}).catch(function(e){t.reject(e)}),t.promise}},o}]),app.factory("Cookie",["$q","$window",function(e,t){function r(){}return r.TIMEOUT=3e5,r._set=function(e,r,n){var s;if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),s="; expires="+o.toGMTString()}else s="";t.document.cookie=e+"="+r+s+"; path=/"},r.set=function(e,t,n){try{var s=[],o=JSON.stringify(t,function(e,t){if("pool"!==e){if("object"==typeof t&&null!==t){if(-1!==s.indexOf(t))return;s.push(t)}return t}});s=null,r._set(e,o,n)}catch(r){console.log("Cookie.set.error serializing",e,t,r)}},r.get=function(e){for(var r=e+"=",n=t.document.cookie.split(";"),s=0;s<n.length;s++){for(var o=n[s];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(r)){var i=o.substring(r.length,o.length),a=null;try{a=JSON.parse(i)}catch(e){console.log("Cookie.get.error parsing",key,e)}return a}}return null},r.delete=function(e){r._set(e,"",-1)},r.on=function(t){function n(){if(a>l)o.reject("timeout");else{var e=r.get(t);e?o.resolve(e):(a+=i,s=setTimeout(n,i))}}var s,o=e.defer(),i=1e3,a=0,l=r.TIMEOUT;return n(),o.promise},r}]),app.factory("LocalStorage",["$q","$window","Cookie",function(e,t,r){function n(){}return n.isSupported=function(){var e=!1;try{e="localStorage"in t&&null!==t.localStorage,e?(t.localStorage.setItem("test","1"),t.localStorage.removeItem("test")):e=!1}catch(t){e=!1}return e}(),n.isSupported?(n.set=function(e,r){try{var n=[],s=JSON.stringify(r,function(e,t){if("pool"!==e){if("object"==typeof t&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t}});n=null,t.localStorage.setItem(e,s)}catch(t){console.log("LocalStorage.set.error serializing",e,r,t)}},n.get=function(e){var r=null;if(void 0!==t.localStorage[e])try{r=JSON.parse(t.localStorage[e])}catch(t){console.log("LocalStorage.get.error parsing",e,t)}return r},n.delete=function(e){t.localStorage.removeItem(e)},n.on=function(n){function s(e){if(clearTimeout(o),e.originalEvent.key==n)try{var t=JSON.parse(e.originalEvent.newValue);i.resolve(t)}catch(e){console.log("LocalStorage.on.error parsing",n,e),i.reject("error parsing "+n)}}var o,i=e.defer(),a=r.TIMEOUT;return angular.element(t).on("storage",s),o=setTimeout(function(){i.reject("timeout")},a),i.promise}):(console.log("LocalStorage.unsupported switching to cookies"),n.set=r.set,n.get=r.get,n.delete=r.delete,n.on=r.on),n}]),app.factory("SessionStorage",["$q","$window","Cookie",function(e,t,r){function n(){}return n.isSupported=function(){var e=!1;try{e="sessionStorage"in t&&void 0!==t.sessionStorage,e?(t.sessionStorage.setItem("test","1"),t.sessionStorage.removeItem("test")):e=!1}catch(t){e=!1}return e}(),n.isSupported?(n.set=function(e,r){try{var n=[],s=JSON.stringify(r,function(e,t){if("pool"!==e){if("object"==typeof t&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t}});n=null,t.sessionStorage.setItem(e,s)}catch(t){console.log("SessionStorage.set.error serializing",e,r,t)}},n.get=function(e){var r=null;if(void 0!==t.sessionStorage[e])try{r=JSON.parse(t.sessionStorage[e])}catch(t){console.log("SessionStorage.get.error parsing",e,t)}return r},n.delete=function(e){t.sessionStorage.removeItem(e)},n.on=function(n){function s(e){if(clearTimeout(o),e.originalEvent.key===n)try{var t=JSON.parse(e.originalEvent.newValue);i.resolve(t)}catch(e){console.log("SessionStorage.on.error parsing",n,e),i.reject("error parsing "+n)}}var o,i=e.defer(),a=r.TIMEOUT;return angular.element(t).on("storage",s),o=setTimeout(function(){i.reject("timeout")},a),i.promise}):(console.log("SessionStorage.unsupported switching to cookies"),n.set=r.set,n.get=r.get,n.delete=r.delete,n.on=r.on),n}]);
//# sourceMappingURL=app.min.js.map
