<header>
    <header-items>
        <li class="nav-item">Profile</li>
    </header-items>
</header>

<main>
    <ul class="nav nav-tabs justify-content-center">
        <li class="nav-item">
            <a class="nav-link" ng-class="{ active: mode == MODES.BEACH }" ng-click="mode = MODES.BEACH">Spiaggia</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" ng-class="{ active: mode == MODES.PRICES }" ng-click="mode = MODES.PRICES">Tariffe</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" ng-class="{ active: mode == MODES.PLACE }" ng-click="mode = MODES.PLACE">Posizione</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" ng-class="{ active: mode == MODES.OPENING }" ng-click="mode = MODES.OPENING">Apertura</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" ng-class="{ active: mode == MODES.INFO }" ng-click="mode = MODES.INFO">Informazioni</a>
        </li>
    </ul>
    <div ng-if="mode == MODES.BEACH" ng-include="'partials/profile/beach'"></div>
    <div ng-if="mode == MODES.PRICES" ng-include="'partials/profile/prices'"></div>
    <div ng-if="mode == MODES.PLACE" ng-include="'partials/profile/place'"></div>
    <div ng-if="mode == MODES.OPENING" ng-include="'partials/profile/opening'"></div>
</main>

<!-- PLACE -->
<script type="text/ng-template" id="partials/profile/place">
    <div class="content mt-3">
        <form name="form" role="form" novalidate autocomplete="off" ng-submit="state.enabled() && form.$valid && submit()" ng-keyup="$event.keyCode == 13 && state.enabled() && form.$valid && submit()">
            <section class="container-fluid container-form">
                <!-- <div mapboxgl access-token="pk.eyJ1IjoiYWN0YXJpYW4iLCJhIjoiY2lqNWU3MnBzMDAyZndnbTM1cjMyd2N2MiJ9.CbuEGSvOAfIYggQv854pRQ" gl-style="'mapbox://styles/mapbox/light-v9'" __gl-center="{ autodiscover: true }" gl-controls="glControls"></div> -->
                <!-- <h6 class="headline foreground light-60">Accedi</h6> -->
                <div class="outer">
                    <mapbox ng-if="model"></mapbox>
                    <div class="container-fluid controls">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="ricerca indirizzo..." ng-model="map.address" ng-model-options="{ allowInvalid: false, debounce: 1000 }">
                            <span class="input-group-btn">
                                <button class="btn btn-primary" type="button" ng-click="map.search()">Cerca</button>
                            </span>
                        </div>
                        <div class="dropdown-menu" ng-style="{ display: map.results.length ? 'block' : 'none' }" style="position: static;">
                            <h6 class="dropdown-header">trovati {{map.results.length}} indirizzi</h6>
                            <span class="dropdown-item" ng-click="map.setAddress(item)" ng-repeat="item in map.results track by $index" ng-bind="item.name"></span>
                        </div>
                    </div>
                </div>
                <div class="inner">
                    <div form="form" control="text" ng-model="model.shopName" title="Stabilimento" placeholder="il nome dello stabilimento" required="true"></div>
                    <div form="form" control="text" ng-model="model.position.lat" title="Latitudine" placeholder="latitudine" validate="number" precision="20" required="true"></div>
                    <div form="form" control="text" ng-model="model.position.lng" title="Longitudine" placeholder="longitudine" validate="number" precision="20" required="true"></div>
                    <div form="form" control="text" ng-model="model.street" title="Via" placeholder="via dello stabilimento" required="false"></div>
                    <div form="form" control="text" ng-model="model.locality" title="Località" placeholder="località dello stabilimento" required="false"></div>
                    <div form="form" control="text" ng-model="model.number" title="N° Civico" placeholder="numero civico" required="false"></div>
                    <div form="form" control="text" ng-model="model.postalCode" title="Cap" placeholder="inserisci il cap" required="true"></div>
                    <div form="form" control="text" ng-model="model.city" title="Città" placeholder="inserisci la città" required="true"></div>
                    <div form="form" control="text" ng-model="model.province" title="Provincia" placeholder="inserisci la provincia" required="false"></div>
                    <div form="form" control="text" ng-model="model.region" title="Regione" placeholder="inserisci la regione" required="false"></div>
                    <div form="form" control="text" ng-model="model.country" title="Stato" placeholder="seleziona lo stato" required="true"></div>
                    <!-- <div form="form" control="select" ng-model="model.type" title="Type" placeholder="selezione un tipo" required="true" source="[{id:1,name:'1'}, {id:2,name:'2'}]"></div> -->
                    <br>
                    <div ng-include="'partials/errors'"></div>
                    <div class="text-center">
                        <button type="button" class="btn btn-primary" ng-class="stateClass()" ng-disabled="stateDisabled()" ng-click="submit()" on-validate="form.$invalid">
                            <span>Salva</span>
                        </button>
                        <!-- <button state="state" on-click="submit()" on-validate="form.$invalid"><span>Accedi</span> <i class="icon-user"></i></button> -->
                    </div>
                </div>
            </section>
        </form>
    </div>
</script>

<!-- BEACH -->
<script type="text/ng-template" id="partials/profile/beach">
    <div class="container-fluid maxw-lg">
        <nav class="navbar navbar-toggleable-md navbar-light">
            <div class="collapse navbar-collapse show">
                <ul class="nav nav-pills mr-auto">
                    <!--
                <li class="nav-item">
                    <a class="nav-link active" href="#">Active</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Link</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Link</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link disabled" href="#">Disabled</a>
                </li>
                -->
                    <li class="nav-item p-1">
                        Ombrelloni <span ng-bind="beach.items.length"></span>
                    </li>
                    <li class="nav-item p-1">
                        File <span ng-bind="beach.cols"></span>
                    </li>
                    <li class="nav-item p-1">
                        Righe <span ng-bind="beach.rows"></span>
                    </li>
                </ul>
                <button type="button" class="btn btn-secondary mr-2" ng-click="controls.setCenter()">centra</button>
                <button type="button" class="btn btn-primary" ng-click="saveItems()">salva</button>
            </div>
        </nav>
    </div>
    <canvas beach unselectable></canvas>

</script>

<!-- PRICES -->
<script type="text/ng-template" id="partials/profile/prices">
    <div class="content mt-3">
        <form name="form" role="form" novalidate autocomplete="off" ng-submit="state.enabled() && form.$valid && submit()" ng-keyup="$event.keyCode == 13 && state.enabled() && form.$valid && submit()">
            <section class="container-fluid container-form">
                <div class="outer">
                    prices
                </div>
            </section>
        </form>
    </div>
</script>

<!-- OPENING -->
<script type="text/ng-template" id="partials/profile/opening">
    <p class="fields">
        <span class="field-control">
                <span ng-click="flags.dateFrom = true" is-open="flags.dateFrom" ng-model="filters.dateFrom" ng-change="source.setDateFrom(filters.dateFrom)" uib-datepicker-popup datepicker-template-url="uib/template/datepicker/datepicker.html" show-button-bar="false" current-text="Oggi" clear-text="Rimuovi" close-text="Chiudi">
                    <span ng-bind="filters.dateFrom || 'seleziona' | date : 'dd-MM-yyyy'"></span> <i class="icon-remove" ng-if="filters.dateFrom" ng-click="stop($event) && (filters.dateFrom = null)"></i> <i class="icon-calendar"></i>
        </span>
        </span><span class="field-control">
                <span ng-click="flags.dateTo = true" is-open="flags.dateTo" ng-model="filters.dateTo" ng-change="source.setDateTo(filters.dateTo)" uib-datepicker-popup datepicker-template-url="uib/template/datepicker/datepicker.html" show-button-bar="false" current-text="Oggi" clear-text="Rimuovi" close-text="Chiudi">
                    <span ng-bind="filters.dateTo || 'seleziona' | date : 'dd-MM-yyyy'"></span> <i class="icon-remove" ng-if="filters.dateTo" ng-click="stop($event) && (filters.dateTo = null)"></i> <i class="icon-calendar"></i>
        </span>
        </span><span class="field" ng-class="{ 'active' : table.has('compare') }" ng-click="table.toggle('compare') && source.update()">
                <span>Confronto anno precedente</span> <i class="icon-check-mark"></i>
        </span>
    </p>
</script>